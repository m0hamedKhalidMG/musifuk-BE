<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ambulance Tracker</title>
    <script src="https://js.pusher.com/7.0/pusher.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Pusher
            const pusher = new Pusher('ea80cde6e77453dc1bf5', {
                cluster: 'mt1',
                encrypted: true,
            });
            const newassignment = '663ead9aa437ca4ad0c62eea'; // Replace with your car number

            const carNumber = 'ABC123'; // Replace with your car number
            const channel = pusher.subscribe(`car_${carNumber}`);
            const channel2 = pusher.subscribe(`car_${newassignment}`);
            const channel3 = pusher.subscribe("newRequestCar-channel");
            channel3.bind('newRequestCar', (data) => {
                console.log('newRequestCar:', data);
                // Handle the updated position data as needed
            });

            channel3.bind('pusher:subscription_succeeded', () => {
                console.log('Subscribed to channel');
            });
            channel2.bind('newassignment', (data) => {
                console.log('newassignment:', data);
                // Handle the updated position data as needed
            });

            channel2.bind('pusher:subscription_succeeded', () => {
                console.log('Subscribed to channel');
            });
            channel.bind('positionUpdated', (data) => {
                console.log('Position updated:', data);
                // Handle the updated position data as needed
            });

            channel.bind('pusher:subscription_succeeded', () => {
                console.log('Subscribed to channel');
            });

            // Example of updating position (simulated, as the client cannot trigger Pusher events)
//             function sendUpdatePosition(newCoordinates) {
//                 fetch('https://musifuk-be.vercel.app/api/update-last-location', {
//                     method: 'PUT',
//                     headers: {
//     'x-auth-token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTk2NjQ0MTAsImlkIjoiNjY0Yjk4ZWI1MTcwYTIyZThjMTkxM2JjIiwicm9sZSI6IkRyaXZlciIsImlhdCI6MTcxOTU3ODAxMH0.4hV9MDnaSmAXzxcxbbwtc_n77sLTlSfbv3VD3lWtqWI',
//     'Content-Type': 'application/json'
//   },
//                     body: JSON.stringify({  newCoordinates })
//                 })
//                 .then(response => response.json())
//                 .then(data => {
//                     console.log('Server response:', data);
//                 })
//                 .catch(error => {
//                     console.error('Error:', error);
//                 });
//             }
//             // Example usage of sendUpdatePosition
//         //    setInterval(() => {
//                 const newCoordinates = [-79.005972, 4.712776];
//                 sendUpdatePosition(newCoordinates);
//             //}, 5000);
        });
    </script>
</head>
<body>
    <h1>Ambulance Tracker</h1>
</body>
</html>
